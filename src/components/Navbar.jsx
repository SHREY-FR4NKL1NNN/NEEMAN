import { useEffect, useRef, useState } from "react";
import { Link } from "react-router-dom";
import { Search, MapPin, ShoppingCart } from "lucide-react";
import { FaBolt } from "react-icons/fa6";
import MegaMenuDropdown from "./MegaMenuDropdown";
import { CENTER_NAV_LINKS } from "./MegaMenu";
import CartSidebar from "../pages/Cart"; // Make sure this is the correct path to your Cart.jsx
import { useCart } from "../context/CartContext";

const NavbarWithScrollLoader = () => {
    const progressRef = useRef(null);
    const [submenuOpen, setSubmenuOpen] = useState(false);
    const [activeMenu, setActiveMenu] = useState(null);
    const submenuTimeout = useRef(null);
    const [navHover, setNavHover] = useState(false);
    const [submenuHover, setSubmenuHover] = useState(false);

  // Cart logic
  const { getCartItemsCount } = useCart();
  const [isCartOpen, setIsCartOpen] = useState(false);

  const toggleCart = () => setIsCartOpen((open) => !open);
  const closeCart = () => setIsCartOpen(false);

    useEffect(() => {
        if (navHover || submenuHover) {
            setSubmenuOpen(true);
        } else {
            submenuTimeout.current = setTimeout(() => setSubmenuOpen(false), 120);
        }
        return () => clearTimeout(submenuTimeout.current);
    }, [navHover, submenuHover]);

    // Helper to get menu data by label
    const getMenuData = (label) => CENTER_NAV_LINKS.find((item) => item.label === label);

    // Handlers for hover logic
    const handleNavLinkEnter = (label) => {
        setActiveMenu(label);
        setNavHover(true);
    };
    const handleNavLinkLeave = () => {
        setNavHover(false);
    };
    const handleSubmenuEnter = () => {
        setSubmenuHover(true);
    };
    const handleSubmenuLeave = () => {
        setSubmenuHover(false);
    };

    return (
        <div className="fixed top-0 left-0 w-full z-50 bg-white shadow-sm">
            {/* Navbar */}
            <div className="w-full bg-white shadow-md py-6 px-8 flex items-center justify-between text-lg md:text-xl">
                {/* Logo */}
                <Link to="/" className="text-2xl font-semibold tracking-widest px-8" aria-label="Go to homepage">
                    <svg width="171.25" height="26.25" viewBox="0 0 274 42" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M7.36682 19.6447H7.50717C8.27778 20.3326 12.4724 25.0456 16.7995 29.2561C20.9545 33.3295 25.9118 38.1393 28.3958 40.4769C28.8009 40.888 29.3438 41.2992 30.0217 41.2992C30.3342 41.2992 30.652 40.9284 30.652 40.0605L31.1022 15.5255C31.1419 13.3303 31.4597 12.6424 32.5428 12.32C33.0406 12.1856 33.3584 12.1856 33.7636 12.1856C34.2137 12.1856 34.4415 12.0029 34.4415 11.7745C34.4415 11.4521 34.084 11.4037 33.5385 11.4037C31.5947 11.4037 30.1065 11.4978 29.6563 11.4978C28.8009 11.4978 26.6824 11.4037 24.6063 11.4037C24.021 11.4037 23.6106 11.4521 23.6106 11.7745C23.6106 12.0029 23.7509 12.1856 24.2408 12.1856C24.7863 12.1856 25.7344 12.1856 26.3196 12.414C27.2676 12.7768 27.6278 13.4646 27.6728 15.848L28.078 33.1495H27.8979C27.3127 32.596 22.0376 27.1092 19.3285 24.4087C13.5529 18.6828 7.5972 12.5081 7.09406 12.0029C6.42407 11.315 5.87856 10.7239 5.38865 10.7239C4.97819 10.7239 4.71072 11.2694 4.71072 12.0513L4.34528 35.1191C4.29761 38.5074 4.1652 39.5634 3.12978 39.8321C2.58426 39.9745 1.86131 40.0202 1.31844 40.0202C0.960945 40.0202 0.693481 40.2029 0.693481 40.4313C0.693481 40.794 1.05098 40.8424 1.58856 40.8424C3.61969 40.8424 5.51841 40.708 5.87591 40.708C6.59885 40.708 8.45256 40.8424 11.0213 40.8424C11.5588 40.8424 11.9243 40.7483 11.9243 40.4313C11.9243 40.2029 11.6992 40.0202 11.2464 40.0202C10.6161 40.0202 9.85343 39.9718 9.16756 39.7434C8.40489 39.4666 7.90704 38.5504 7.81965 35.5275L7.36682 19.6447ZM48.5641 29.5328C48.5641 33.1012 48.5641 36.1724 48.384 37.8168C48.2516 38.9615 48.0265 39.695 47.2082 39.8777C46.8507 39.9718 46.3979 40.0202 45.8073 40.0202C45.3148 40.0202 45.1771 40.2432 45.1771 40.4313C45.1771 40.708 45.4498 40.8424 45.9477 40.8424C46.758 40.8424 47.7537 40.7967 48.6965 40.7483C49.6445 40.7483 50.5078 40.708 50.9527 40.708C52.1285 40.708 53.6141 40.7483 55.5578 40.7967C57.4963 40.8907 59.8849 40.931 62.8667 40.931C64.3523 40.931 64.7125 40.931 64.9826 39.9288C65.2077 39.1549 65.5281 36.4948 65.5281 35.6242C65.5281 35.2131 65.4804 34.708 65.1706 34.708C64.8978 34.708 64.8052 34.8907 64.7125 35.3072C64.4477 36.9032 63.9948 37.7308 62.9991 38.1903C61.9637 38.6471 60.298 38.6874 59.2546 38.6874C55.1924 38.6874 53.9769 38.0936 53.8842 35.4415C53.8365 34.2969 53.8842 31.0026 53.8842 29.6699V26.5583C53.8842 26.3299 53.9319 26.1472 54.1093 26.1472C55.105 26.1472 59.6121 26.2413 60.3351 26.3299C61.8207 26.4723 62.3185 27.0635 62.5463 27.8454C62.639 28.3452 62.639 28.8503 62.6866 29.2588C62.6866 29.4468 62.774 29.5812 63.0441 29.5812C63.4016 29.5812 63.4493 29.0277 63.4493 28.7133C63.4493 28.4365 63.542 26.8808 63.6294 26.0989C63.8624 24.132 63.9471 23.4925 63.9471 23.2641C63.9471 23.0357 63.8147 22.853 63.6294 22.853C63.4493 22.853 63.3169 23.0814 62.9991 23.3581C62.5939 23.7209 62.0564 23.8552 61.1083 23.9519C60.2053 24.0406 55.0626 24.0406 54.1596 24.0406C53.9345 24.0406 53.8868 23.8579 53.8868 23.6295V14.0155C53.8868 13.7871 53.9795 13.6527 54.1596 13.6527C54.9699 13.6527 59.7075 13.7414 60.3854 13.8354C62.3689 14.0181 62.6893 14.5636 63.0018 15.2488C63.2269 15.7056 63.2745 16.3934 63.2745 16.6702C63.2745 16.9926 63.3222 17.1754 63.5923 17.1754C63.9048 17.1754 63.9975 16.7186 64.0425 16.5359C64.1299 16.0791 64.2226 14.3809 64.2623 13.9698C64.355 12.1856 64.5801 11.7261 64.5801 11.4521C64.5801 11.2694 64.5324 11.0893 64.3152 11.0893C64.1299 11.0893 63.9048 11.2237 63.677 11.272C63.3646 11.3204 62.7343 11.4548 62.0114 11.5004C61.2407 11.5488 52.4462 11.5004 51.1857 11.5004C50.0576 11.5004 47.5286 11.4064 45.4498 11.4064C44.8646 11.4064 44.5468 11.5004 44.5468 11.7772C44.5468 12.054 44.8196 12.1883 45.2247 12.1883C45.81 12.1883 46.4932 12.2367 46.8057 12.3227C48.0662 12.6935 48.4317 13.1046 48.519 14.4319C48.5667 15.6653 48.5667 16.7696 48.5667 22.6676L48.5641 29.5328ZM78.9251 29.5328C78.9251 33.1012 78.9251 36.1724 78.745 37.8168C78.6126 38.9615 78.3796 39.695 77.5692 39.8777C77.2117 39.9718 76.7589 40.0202 76.1684 40.0202C75.6705 40.0202 75.5381 40.2432 75.5381 40.4313C75.5381 40.708 75.8109 40.8424 76.3087 40.8424C77.119 40.8424 78.1068 40.7967 79.0575 40.7483C80.0055 40.7483 80.8635 40.708 81.3137 40.708C82.4895 40.708 83.9751 40.7483 85.9135 40.7967C87.8573 40.8907 90.2486 40.931 93.2277 40.931C94.7133 40.931 95.0735 40.931 95.3462 39.9288C95.5713 39.1549 95.8918 36.4948 95.8918 35.6242C95.8918 35.2131 95.8441 34.708 95.5263 34.708C95.2536 34.708 95.1688 34.8907 95.0761 35.3072C94.8034 36.9032 94.3585 37.7308 93.3628 38.1903C92.3274 38.6471 90.6537 38.6874 89.6183 38.6874C85.556 38.6874 84.3352 38.0936 84.2479 35.4415C84.2002 34.2969 84.2479 31.0026 84.2479 29.6699V26.5583C84.2479 26.3299 84.2929 26.1472 84.4729 26.1472C85.4634 26.1472 89.9758 26.2413 90.6987 26.3299C92.187 26.4723 92.6822 27.0635 92.91 27.8454C93.0026 28.3452 93.0026 28.8503 93.0503 29.2588C93.0503 29.4468 93.1377 29.5812 93.4078 29.5812C93.7653 29.5812 93.813 29.0277 93.813 28.7133C93.813 28.4365 93.9057 26.8808 93.993 26.0989C94.2181 24.132 94.3108 23.4925 94.3108 23.2641C94.3108 23.0357 94.1784 22.853 93.993 22.853C93.813 22.853 93.6753 23.0814 93.3628 23.3581C92.9576 23.7209 92.42 23.8552 91.472 23.9519C90.569 24.0406 85.4263 24.0406 84.5233 24.0406C84.2982 24.0406 84.2505 23.8579 84.2505 23.6295V14.0155C84.2505 13.7871 84.3379 13.6527 84.5233 13.6527C85.3336 13.6527 90.0711 13.7414 90.7491 13.8354C92.7325 14.0181 93.053 14.5636 93.3654 15.2488C93.5905 15.7056 93.6382 16.3934 93.6382 16.6702C93.6382 16.9926 93.6779 17.1754 93.9507 17.1754C94.2684 17.1754 94.3611 16.7186 94.4009 16.5359C94.4935 16.0791 94.5862 14.3809 94.6259 13.9698C94.7186 12.1856 94.9437 11.7261 94.9437 11.4521C94.9437 11.2694 94.8961 11.0893 94.671 11.0893C94.4909 11.0893 94.2658 11.2237 94.0407 11.272C93.7282 11.3204 93.09 11.4548 92.3671 11.5004C91.6044 11.5488 82.8099 11.5004 81.5414 11.5004C80.4133 11.5004 77.8923 11.4064 75.8135 11.4064C75.223 11.4064 74.9105 11.5004 74.9105 11.7772C74.9105 12.054 75.1832 12.1883 75.5884 12.1883C76.1737 12.1883 76.8569 12.2367 77.1694 12.3227C78.4299 12.6935 78.7953 13.1046 78.8827 14.4319C78.9304 15.6653 78.9304 16.7696 78.9304 22.6676V29.5328H78.9251ZM107.75 36.9462C107.57 38.2333 107.213 39.7891 106.13 39.9234C105.491 40.0175 105.226 40.0175 104.909 40.0175C104.504 40.0175 104.278 40.2002 104.278 40.3802C104.278 40.743 104.596 40.837 105.001 40.837C106.262 40.837 108.161 40.7026 108.923 40.7026C109.646 40.7026 111.452 40.837 113.118 40.837C113.703 40.837 114.066 40.743 114.066 40.3802C114.066 40.1975 113.793 40.0175 113.436 40.0175C113.078 40.0175 112.713 39.9691 112.035 39.8294C111.357 39.695 110.814 39.4183 110.814 38.6847C110.814 38.0452 110.867 37.5454 110.954 36.8602L112.845 21.8427H112.986C114.294 24.5431 116.643 29.2588 116.955 29.9923C117.405 31.0913 120.567 37.043 121.507 38.8298C122.146 40.0228 122.596 40.7967 123.086 40.7967C123.544 40.7967 123.764 40.4339 124.667 38.6014L133.196 21.3859H133.337L135.548 38.1903C135.68 39.2866 135.587 39.7461 135.362 39.8321C135.098 39.9261 134.912 40.0605 134.912 40.2432C134.912 40.4796 135.137 40.6597 136.088 40.708C137.666 40.7967 143.31 40.931 144.297 40.931C144.888 40.931 145.341 40.7967 145.341 40.4796C145.341 40.2432 145.068 40.1088 144.702 40.1088C144.213 40.1088 143.58 40.0631 142.452 39.7461C141.231 39.3833 140.873 38.3247 140.508 35.901L136.896 11.9599C136.763 11.1377 136.31 10.7266 135.993 10.7266C135.635 10.7266 135.275 11.0436 134.957 11.6832L124.312 33.4773L113.666 11.9599C113.121 10.9093 112.851 10.7266 112.451 10.7266C112.133 10.7266 111.767 11.0893 111.68 11.7288L107.75 36.9462ZM163.793 18.8655C163.841 18.7311 163.886 18.5027 164.026 18.5027C164.113 18.5027 164.158 18.7311 164.206 18.8655L172.098 39.1496C172.278 39.601 172.01 39.9718 171.74 40.0175C171.33 40.0578 171.242 40.2002 171.242 40.4286C171.242 40.7053 171.692 40.7053 172.418 40.7456C175.757 40.8397 178.644 40.8397 180.045 40.8397C181.53 40.8397 181.758 40.7456 181.758 40.4286C181.758 40.1518 181.573 40.0175 181.212 40.0175C180.762 40.0175 180.309 39.9691 179.724 39.8751C179.001 39.7407 177.873 39.2356 176.34 35.7129C173.819 29.8069 167.18 14.0611 166.237 11.9062C165.827 11.0383 165.647 10.6728 165.061 10.6728C164.656 10.6728 164.338 11.1296 163.886 12.2286L153.51 36.5351C152.695 38.502 152.017 39.695 150.219 39.9691C149.853 39.9691 149.403 40.0175 149.043 40.0175C148.725 40.0175 148.593 40.2002 148.593 40.4286C148.593 40.7456 148.818 40.8397 149.315 40.8397C151.386 40.8397 153.51 40.7053 153.915 40.7053C155.176 40.7053 157.03 40.8397 158.335 40.8397C158.74 40.8397 158.965 40.7456 158.965 40.4286C158.965 40.2002 158.878 40.0175 158.38 40.0175H157.79C156.574 40.0175 156.209 39.601 156.209 38.9131C156.209 38.4563 156.394 37.4998 156.799 36.5351L163.793 18.8655ZM193.389 19.6447H193.521C194.292 20.3326 198.486 25.0456 202.819 29.2561C206.968 33.3295 211.931 38.1393 214.407 40.4769C214.817 40.888 215.355 41.2992 216.033 41.2992C216.351 41.2992 216.663 40.9284 216.663 40.0605L217.113 15.5255C217.161 13.3303 217.471 12.6424 218.559 12.32C219.052 12.1856 219.37 12.1856 219.775 12.1856C220.225 12.1856 220.453 12.0029 220.453 11.7745C220.453 11.4521 220.095 11.4037 219.55 11.4037C217.611 11.4037 216.126 11.4978 215.673 11.4978C214.817 11.4978 212.694 11.4037 210.623 11.4037C210.032 11.4037 209.627 11.4521 209.627 11.7745C209.627 12.0029 209.759 12.1856 210.257 12.1856C210.803 12.1856 211.751 12.1856 212.333 12.414C213.276 12.7768 213.642 13.4646 213.687 15.848L214.092 33.1495H213.912C213.321 32.596 208.043 27.1092 205.337 24.4087C199.561 18.6854 193.608 12.5081 193.111 12.0029C192.433 11.315 191.895 10.7239 191.397 10.7239C190.992 10.7239 190.719 11.2694 190.719 12.0513L190.354 35.1191C190.314 38.5074 190.174 39.5634 189.138 39.8321C188.593 39.9745 187.878 40.0202 187.332 40.0202C186.975 40.0202 186.702 40.2029 186.702 40.4313C186.702 40.794 187.06 40.8424 187.605 40.8424C189.636 40.8424 191.535 40.708 191.892 40.708C192.61 40.708 194.461 40.8424 197.035 40.8424C197.573 40.8424 197.938 40.7483 197.938 40.4313C197.938 40.2029 197.705 40.0202 197.255 40.0202C196.625 40.0202 195.862 39.9718 195.184 39.7434C194.421 39.4666 193.924 38.5504 193.831 35.5275L193.389 19.6447ZM233.008 6.14258C231.607 6.14258 230.704 6.14258 230.704 6.83045C230.704 7.51832 231.832 9.79957 232.377 15.5255C232.557 17.1297 232.735 17.8149 233.008 17.8149C233.272 17.8149 233.452 17.127 233.638 15.5255C234.175 9.80226 235.304 7.51832 235.304 6.83045C235.304 6.14258 234.401 6.14258 233.008 6.14258ZM253.976 41.3448C256.094 41.3448 258.708 41.1164 260.607 39.7407C263.493 37.6798 264.576 35.3421 264.576 32.4616C264.576 28.939 262.95 25.9618 257.72 23.033L256.094 22.1167C252.53 20.1042 251.899 18.7284 251.899 16.9926C251.899 14.3325 254.468 12.8251 257.315 12.8251C259.884 12.8251 261.144 13.9214 261.735 14.6576C262.59 15.6626 262.77 16.8529 262.77 17.2237C262.77 17.6805 262.91 17.9116 263.175 17.9116C263.493 17.9116 263.673 17.4951 263.673 16.6729C263.673 13.6097 263.813 12.5107 263.813 12.0056C263.813 11.7288 263.628 11.5945 263.268 11.5004C262.233 11.2237 260.201 10.8609 257.625 10.8609C252.122 10.8609 247.609 13.9241 247.609 18.6881C247.609 22.1221 249.143 24.7285 253.835 27.5256L256.139 28.8987C259.656 31.008 260.061 32.6981 260.061 34.3882C260.061 37.137 257.982 39.3377 254.558 39.3377C252.077 39.3377 249.103 38.3757 248.245 35.4926C248.012 34.8047 247.88 33.9771 247.88 33.48C247.88 33.2033 247.832 32.8325 247.474 32.8325C247.157 32.8325 246.977 33.2489 246.977 33.8428C246.929 34.4823 246.751 36.9059 246.751 39.0152C246.751 39.8831 246.884 40.0658 247.522 40.3426C249.235 41.1164 251.672 41.3448 253.976 41.3448Z" fill="#020203"></path>
                        <path d="M269.708 8.74347C267.367 8.75959 265.458 6.84377 265.442 4.4631C265.426 2.07974 267.312 0.128983 269.645 0.118235C272.01 0.1048 273.932 2.00988 273.943 4.38249C273.956 6.80347 272.089 8.72735 269.708 8.74347ZM269.698 8.18458C271.75 8.17652 273.4 6.49984 273.395 4.42548C273.389 2.33769 271.729 0.663694 269.671 0.674442C267.632 0.685189 265.99 2.36187 265.993 4.43354C265.996 6.51058 267.656 8.19264 269.698 8.18458Z" fill="#020203"></path>
                        <path d="M270.556 4.99783C270.993 5.5003 271.411 5.98127 271.869 6.50792C271.514 6.50792 271.212 6.51061 270.911 6.50255C270.871 6.50255 270.828 6.44075 270.797 6.40313C270.45 6.00008 270.1 5.59972 269.759 5.19398C269.684 5.10531 269.608 5.06501 269.491 5.0677C269.295 5.07576 269.099 5.07038 268.882 5.07038C268.882 5.55673 268.882 6.02426 268.882 6.49986C268.612 6.49986 268.366 6.49986 268.104 6.49986C268.104 5.07844 268.104 3.65434 268.104 2.23023C268.125 2.22486 268.141 2.21411 268.156 2.21411C268.887 2.22217 269.618 2.18724 270.344 2.24904C271.546 2.35384 271.867 3.56836 271.44 4.37983C271.292 4.66196 271.048 4.83661 270.749 4.93066C270.693 4.94947 270.64 4.97096 270.556 4.99783ZM268.885 4.32877C269.361 4.32877 269.83 4.35564 270.294 4.32071C270.632 4.29384 270.834 3.99827 270.828 3.65165C270.823 3.31578 270.617 3.02021 270.288 2.99603C269.825 2.96378 269.356 2.98797 268.885 2.98797C268.885 3.43401 268.885 3.87467 268.885 4.32877Z" fill="#020203"></path>
                    </svg>
                </Link>
                {/* Center Links */}
                <div className="space-x-6 hidden lg:flex items-center relative">
                    {['NEW', 'MEN', 'WOMEN', 'ABOUT US', 'OFFERS'].map((item) => (
                        <button
                            key={item}
                            className="flex items-center gap-1 text-sm font-light relative"
                            onMouseEnter={() => ['NEW', 'MEN', 'WOMEN', 'OFFERS'].includes(item) && handleNavLinkEnter(item)}
                            onMouseLeave={() => ['NEW', 'MEN', 'WOMEN', 'OFFERS'].includes(item) && handleNavLinkLeave()}
                        >
                            {item}
                            {(item === 'NEW' || item === 'MEN' || item === 'WOMEN' || item === 'OFFERS') && (
                                <span className="text-xs">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 18 18" id="Keyboard-Arrow-Down--Streamline-Rounded-Material" height={18} width={18} ><desc>{"\n    Keyboard Arrow Down Streamline Icon: https://streamlinehq.com\n  "}</desc><path fill="#000000" d="M9.0001125 11.325c-0.07500000000000001 0 -0.1437375 -0.012487500000000002 -0.20625000000000002 -0.037500000000000006 -0.062475 -0.0250125 -0.1249875 -0.06873749999999999 -0.1875 -0.13124999999999998l-3.7125000000000004 -3.7125000000000004c-0.11249999999999999 -0.11249999999999999 -0.1656 -0.24686249999999998 -0.159375 -0.40312499999999996 0.0062625 -0.1562625 0.06562499999999999 -0.290625 0.17812499999999998 -0.40312499999999996 0.11249999999999999 -0.11249999999999999 0.2469 -0.16875 0.40312499999999996 -0.16875 0.1562625 0 0.290625 0.056249999999999994 0.40312499999999996 0.16875l3.28125 3.3000000000000003 3.3000000000000003 -3.3000000000000003c0.11249999999999999 -0.11249999999999999 0.24375000000000002 -0.1656375 0.39375000000000004 -0.159375 0.15000000000000002 0.0062625 0.28125 0.06562499999999999 0.39375000000000004 0.17812499999999998 0.11249999999999999 0.11249999999999999 0.16875 0.24686249999999998 0.16875 0.40312499999999996 0 0.1562625 -0.056249999999999994 0.290625 -0.16875 0.40312499999999996l-3.6937499999999996 3.6937499999999996c-0.062475 0.0625125 -0.1249875 0.1062375 -0.1875 0.13124999999999998 -0.062475 0.0250125 -0.13124999999999998 0.037500000000000006 -0.20625000000000002 0.037500000000000006Z" strokeWidth={0.375} /></svg>
                                </span>
                            )}
                        </button>
                    ))}
                </div>
                {/* Submenu Dropdown - render as direct child, not inside absolute wrapper */}
                {submenuOpen && getMenuData(activeMenu)?.megaMenu && (
                    <div onMouseEnter={handleSubmenuEnter} onMouseLeave={handleSubmenuLeave}>
                        <MegaMenuDropdown megaMenu={getMenuData(activeMenu).megaMenu} topClass="top-20" transition />
                    </div>
                )}

                {/* Right Icons */}
                <div className="flex items-center space-x-6">
                    <div className="flex items-center gap-1 cursor-pointer text-sm font-light">
                        <Search className="w-4 h-4" />
                        <span>SEARCH</span>
                    </div>
                    <div className="flex items-center gap-1 cursor-pointer text-sm font-light">
                        <MapPin className="w-4 h-4" />
                        <span>FIND STORES</span>
                    </div>
                    <div className="border-l h-4 border-gray-300"></div>
                    <div className="flex items-center gap-1 cursor-pointer text-sm font-light">
                        <FaBolt className="text-yellow-500" />
                        <span>LOGIN</span>
                    </div>
                    {/* Cart Button */}
                    <button
                        className="relative flex items-center gap-1 cursor-pointer text-sm font-light focus:outline-none"
                        onClick={toggleCart}
                        aria-label="Open cart"
                    >
                        <ShoppingCart className="w-5 h-5" />
                        <span>CART</span>
                        <span className="absolute -top-2 -right-2 bg-[#c5a97c] text-white text-[10px] w-4 h-4 flex items-center justify-center rounded-full">
                            {getCartItemsCount()}
                        </span>
                    </button>
                </div>
            </div>
            {/* Scroll Loader */}
            <div className="h-[4px] bg-gray-200 overflow-hidden">
                <div
                    ref={progressRef}
                    id="scroll-progress"
                    className="h-full bg-[#c5a97c] transition-all ease-linear"
                    style={{ width: "0%", border: '1px solid #BD9966' }}
                />
            </div>
            {/* Cart Sidebar */}
            <CartSidebar isOpen={isCartOpen} onClose={closeCart} />
        </div>
    );
};

export default NavbarWithScrollLoader;
